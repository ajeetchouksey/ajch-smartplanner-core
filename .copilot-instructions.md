# GitHub Copilot Instructions for SmartPlanner Core

## Project Overview

SmartPlanner Core is a **modular, AI/ML-powered planner platform** with strong emphasis on:
- **Privacy-first design** - Minimal cloud data storage, client-side data retention
- **Compliance** - Built with data protection regulations in mind  
- **Modularity** - Reusable services across multiple planner applications
- **AI Integration** - Azure OpenAI powered recommendations and chatbot assistance

## Architecture & Technology Stack

### Core Stack
- **Frontend:** React.js + TypeScript + Vite
- **Backend:** Azure Functions (Node.js + TypeScript)
- **Database:** Azure Cosmos DB (minimal data storage)
- **Authentication:** Azure AD B2C
- **AI/ML:** Azure OpenAI, Azure Cognitive Services
- **Storage:** Azure Blob Storage (minimal) + Local Storage (primary)

### Project Structure
```
├── apps/                    # Individual planner applications
│   ├── travel/             # Trip planning and itinerary management
│   ├── finance/            # Budget tracking and financial planning
│   ├── health/             # Health goals and wellness tracking
│   └── day/                # Daily task and schedule management
├── shared/                  # Reusable services and components
│   ├── auth/               # Azure AD B2C integration
│   ├── profile/            # User profile and group management
│   ├── chatbot/            # AI-powered assistant using Azure OpenAI
│   ├── notifications/      # Multi-channel notification system
│   ├── analytics/          # Privacy-compliant analytics
│   ├── data-storage/       # Minimal cloud storage + client-side encryption
│   ├── audit-logging/      # Compliance and audit trail
│   ├── ui-library/         # Shared design system and components
│   ├── settings/           # Centralized configuration management
│   └── mcp/                # Model Context Protocol implementation
```

## Development Guidelines

### React Component Patterns
Always use functional components with TypeScript:

```typescript
interface ComponentProps {
  variant?: 'primary' | 'secondary';
  disabled?: boolean;
  onClick?: () => void;
  children: React.ReactNode;
}

export const Component: React.FC<ComponentProps> = ({ 
  variant = 'primary', 
  disabled = false, 
  onClick, 
  children 
}) => {
  return (
    <button 
      className={`btn btn-${variant} ${disabled ? 'btn-disabled' : ''}`}
      disabled={disabled}
      onClick={onClick}
    >
      {children}
    </button>
  );
};
```

### Azure Functions (v4 Programming Model)
```typescript
import { app, HttpRequest, HttpResponseInit, InvocationContext } from '@azure/functions';

export async function httpTrigger(request: HttpRequest, context: InvocationContext): Promise<HttpResponseInit> {
    context.log(`Http function processed request for url "${request.url}"`);
    
    // Minimal data processing - respect privacy principles
    const body = await request.text();
    
    return { 
        status: 200,
        jsonBody: { message: 'Success' }
    };
}

app.http('httpTrigger', {
    methods: ['GET', 'POST'],
    authLevel: 'function',
    handler: httpTrigger
});
```

### Data Storage Patterns (Privacy-First)
```typescript
interface UserData {
  // Local-only sensitive data
  localData: {
    personalDetails: PersonalInfo;
    preferences: UserPreferences;
    documents: Document[];
  };
  
  // Minimal cloud sync (aggregated, anonymized)
  cloudSync: {
    userId: string;
    lastSync: Date;
    aggregatedMetrics: AnalyticsData;
  };
}

// Always encrypt before cloud storage
const encryptedData = await encryptClientSide(sensitiveData);
```

## Privacy & Compliance Requirements

### Critical Rules
- **Never store** personally identifiable information (PII) in cloud without explicit consent
- **Always encrypt** sensitive data at rest and in transit
- **Implement** data retention policies and right to deletion
- **Log minimal** information for audit trails
- **Process locally** when possible before sending to Azure OpenAI
- **Anonymize** data sent to AI services

### AI/ML Integration Guidelines
- Implement content filtering and safety measures
- Respect usage limits and cost optimization
- Use Azure OpenAI responsibly with proper error handling
- Always validate AI-generated content before presenting to users

## Development Commands

### UI Library Development
```bash
npm run dev:ui                    # UI component playground
npm run build:ui                  # Build UI library
npm run preview:ui                # Preview built UI library
```

### Testing & Building
```bash
npm test                          # Run all tests
npm run test:watch                # Watch mode testing
npm run test:e2e                  # End-to-end tests
npm run build:all                 # Build everything
```

## Error Handling Standards
```typescript
interface AppError {
  code: string;
  message: string;
  details?: unknown;
  timestamp: Date;
  userId?: string; // Only if safe to log
}

const handleError = (error: unknown): AppError => ({
  code: 'GENERIC_ERROR',
  message: error instanceof Error ? error.message : 'Unknown error',
  timestamp: new Date()
});
```

## Security Checklist
- [ ] All API endpoints have proper authentication
- [ ] Input validation on both client and server
- [ ] HTTPS everywhere
- [ ] No sensitive data in logs
- [ ] Regular dependency updates
- [ ] Content Security Policy implemented

## Key Principles for Code Generation

1. **Privacy First**: Always consider data privacy in any code you generate
2. **Minimal Cloud Data**: Prefer client-side storage and processing
3. **TypeScript Everywhere**: Use strong typing for all new code
4. **Modular Design**: Create reusable components and services
5. **Error Handling**: Include proper error handling in all functions
6. **Documentation**: Add meaningful comments explaining business logic
7. **Testing**: Consider testability when generating new code
8. **Performance**: Implement lazy loading, memoization, and debouncing where appropriate

Remember: This is a **privacy-first, AI-powered, modular, and compliant** platform. All code should reflect these core principles.